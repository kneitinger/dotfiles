#!/usr/bin/env bash

# shellcheck disable=SC2088

TMPFILE=/tmp/$(basename "$0")_$(date +"%F_%H-%M-%S").png || exit 1

scrot -s "$TMPFILE"
echo "$TMPFILE"

NAME=$(zenity --entry --text="Image Name")
if [ -z "$NAME" ]; then
    rm "$TMPFILE"
    exit 1
fi

IMG_PATH="$HOME/notes/.images/$NAME"
if [ -d "$(dirname "$IMG_PATH")" ]; then

    mv "$TMPFILE" "$IMG_PATH"
    echo "~/notes/.images/$NAME" | xclip
else
    zenity --error --text="Note image directory does not exist, using path $TMPFILE"
    echo "$TMPFILE" | xclip
fi
