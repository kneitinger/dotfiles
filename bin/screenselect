#!/usr/bin/env bash

# Launches a rofi (https://davedavenport.github.io/rofi/) window populated with
# all xrandr scripts in ~/.screenlayout/$MODEL, and executes the chosen layout

LAYOUT="$(find -L "$HOME/.screenlayout/$HOSTNAME" -type f -exec basename {} \; | \
         rofi -show run -dmenu -p "Select Layout" -i )"

if [ -n "$LAYOUT" ]; then
    "$HOME/.screenlayout/$HOSTNAME/$LAYOUT"

    # Check for background image files and reset the background via feh
    # upon any changes.
    #   - .background-image: used by nixos/lightdm
    #   - .bg.*: used by me non-nixos systems
    if [ -f "$HOME/.background-image" ]; then
        feh --bg-fill "$HOME/.background-image"
    elif [ -f "$HOME/.bg.jpg" ]; then
        feh --bg-fill "$HOME/.bg.jpg"
    elif [ -f "$HOME/.bg.png" ]; then
        feh --bg-fill "$HOME/.bg.png"
    fi
fi
